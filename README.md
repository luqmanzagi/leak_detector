# leak_detector

In order to identify encoded, hashed or obfuscated leaks, we used **[Englehardt et al.’s method](https://petsymposium.org/2018/files/papers/issue1/paper42-2018-1-source.pdf)**. For each website, we start with the email and password we filled, and compute a precomputed pool that contains all possible sets of tokens by iteratively applying the hashes and encodings. We then search for the leaks in the referrer header, cookies, URL and POST bodies of the requests, by splitting the contents by potential separator characters, such as ‘=’. We apply all possible decodings and we check whether the decoded result is in the precomputed pool. We repeat this process until we reach a level of three layers of encodings or decodings.

To run leak detector you can use the ```run_all_leak_detection.sh``` which requires the folder name containing json results and the log file that were created after the crawl was completed.

Leak detector also checks the leaks to tracker domains flagged as a tracker by one of  **[Disconnect](https://github.com/disconnectme/disconnect-tracking-protection)**,  **[Who-tracks.me](https://github.com/whotracksme/whotracks.me)**. On the other hand, **[DuckDuckGo](https://staticcdn.duckduckgo.com/trackerblocking/v2.1/tds.json)** blocklists and **[uBlock Origin](https://github.com/gorhill/uBlock)** have only Node.js based detection, so to check whether these blocklists block the requests or not, you need to use ```u_block_tds_check.js```. After the leak detection process was completed, this script can be used by passing the CSV containing the results. This Node.js script adds the columns indicating whether uBlock Origin and DDG block the related request or not.
